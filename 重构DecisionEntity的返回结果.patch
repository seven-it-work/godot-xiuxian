Index: README.md
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/README.md b/README.md
--- a/README.md	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/README.md	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -13,3 +13,4 @@
 1、为什么有怀孕但是却们没有生产孩子呢？（已修复）
 2、存在内存泄露问题，很多对象创建了却没有回收 （已修复，通过对象回收器来手动回收）
 3、属性存在问题，一直升级的话，可能会超出阈值，比如冷却时间是负向增长，一直减就出现负值冷却值不合理
+4、双修强度有点强，会加双方灵气，待增强一下双修的触发条件
Index: asserts/组件图片/范围.png.import
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/asserts/组件图片/范围.png.import b/asserts/组件图片/范围.png.import
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/asserts/组件图片/范围.png.import	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,34 @@
+[remap]
+
+importer="texture"
+type="CompressedTexture2D"
+uid="uid://ynkvk3qhbj80"
+path="res://.godot/imported/范围.png-e1618676510a5a9167e8aefa6f1d76b2.ctex"
+metadata={
+"vram_texture": false
+}
+
+[deps]
+
+source_file="res://asserts/组件图片/范围.png"
+dest_files=["res://.godot/imported/范围.png-e1618676510a5a9167e8aefa6f1d76b2.ctex"]
+
+[params]
+
+compress/mode=0
+compress/high_quality=false
+compress/lossy_quality=0.7
+compress/hdr_compression=1
+compress/normal_map=0
+compress/channel_pack=0
+mipmaps/generate=false
+mipmaps/limit=-1
+roughness/mode=0
+roughness/src_normal=""
+process/fix_alpha_border=true
+process/premult_alpha=false
+process/normal_map_invert_y=false
+process/hdr_as_srgb=false
+process/hdr_clamp_exposure=false
+process/size_limit=0
+detect_3d/compress_to=1
Index: asserts/组件图片/进度条.png.import
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/asserts/组件图片/进度条.png.import b/asserts/组件图片/进度条.png.import
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/asserts/组件图片/进度条.png.import	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,34 @@
+[remap]
+
+importer="texture"
+type="CompressedTexture2D"
+uid="uid://b3awwtrummxk5"
+path="res://.godot/imported/进度条.png-3fa668df3b4f4ec3634ee431cad1f284.ctex"
+metadata={
+"vram_texture": false
+}
+
+[deps]
+
+source_file="res://asserts/组件图片/进度条.png"
+dest_files=["res://.godot/imported/进度条.png-3fa668df3b4f4ec3634ee431cad1f284.ctex"]
+
+[params]
+
+compress/mode=0
+compress/high_quality=false
+compress/lossy_quality=0.7
+compress/hdr_compression=1
+compress/normal_map=0
+compress/channel_pack=0
+mipmaps/generate=false
+mipmaps/limit=-1
+roughness/mode=0
+roughness/src_normal=""
+process/fix_alpha_border=true
+process/premult_alpha=false
+process/normal_map_invert_y=false
+process/hdr_as_srgb=false
+process/hdr_clamp_exposure=false
+process/size_limit=0
+detect_3d/compress_to=1
Index: main.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.tscn b/main.tscn
--- a/main.tscn	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/main.tscn	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -27,7 +27,7 @@
 size_flags_vertical = 3
 
 [node name="玩家信息" type="ScrollContainer" parent="HBoxContainer"]
-custom_minimum_size = Vector2(180, 0)
+custom_minimum_size = Vector2(200, 0)
 layout_mode = 2
 
 [node name="VBoxContainer" type="VBoxContainer" parent="HBoxContainer/玩家信息"]
@@ -65,7 +65,6 @@
 [node name="游戏速度" type="SpinBox" parent="HBoxContainer/玩家信息/VBoxContainer/相关按钮/游戏速度"]
 layout_mode = 2
 min_value = 1.0
-max_value = 10.0
 value = 1.0
 
 [node name="core" type="ScrollContainer" parent="HBoxContainer"]
@@ -84,7 +83,7 @@
 theme_override_styles/panel = SubResource("StyleBoxFlat_bfejm")
 
 [node name="tips" type="ScrollContainer" parent="HBoxContainer"]
-custom_minimum_size = Vector2(180, 0)
+custom_minimum_size = Vector2(200, 0)
 layout_mode = 2
 
 [node name="地图点击tips" parent="HBoxContainer/tips" instance=ExtResource("2_jl8uk")]
Index: obj/DecisionEntity.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/DecisionEntity.gd b/obj/DecisionEntity.gd
--- a/obj/DecisionEntity.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/DecisionEntity.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -2,38 +2,74 @@
 class_name DecisionEntity
 extends Node
 
-enum Result{
-	SUCCESS=200,
-	FAILURE=0
-}
+# code说明：
+# 200:成功
+# 500:失败
+# -1:系统错误（默认错误码）
+
+static func Success(msg:String="成功",data:Dictionary={})->Dictionary:
+	return {
+		"code":200,
+		"msg":msg,
+		"data":data,
+	}
+	
+static func Error(msg:String="失败",data:Dictionary={})->Dictionary:
+	return {
+		"code":500,
+		"msg":msg,
+		"data":data,
+	}
+
+	
+static func ErrorCode(code:int,msg:String="失败",data:Dictionary={})->Dictionary:
+	return {
+		"code":code,
+		"msg":msg,
+		"data":data,
+	}
+
+static func is_success(dic:Dictionary)->bool:
+	if dic:
+		return dic.get("code",-1)==200
+	return false
 
 ## 获取执行动作key
 func get_action_key(dic:Dictionary={})->String:
 	return ""
 
-## 执行前的条件判断 0表示失败 200 表示成功
-func _before_execute(dic:Dictionary={})->int:
-	return Result.SUCCESS
+## 执行前的条件判断 0表示失败 200 表示成功（这里一般是ai的扩展行为）
+func _before_execute(dic:Dictionary={})->Dictionary:
+	return DecisionEntity.Success()
+
+## 强制运行条件（不要在这里放置概率，ai和玩家都用这个）
+func can_do_decision(dic:Dictionary={})->Dictionary:
+	return DecisionEntity.Success()
 
 ## 执行后
 func _after_execute(dic:Dictionary={}):
 	pass
 
 ## 执行 0表示失败 200 表示成功
-func _execute(dic:Dictionary={})->int:
-	return Result.SUCCESS
+func _execute(dic:Dictionary={})->Dictionary:
+	return DecisionEntity.Success()
 
 ## 执行 0表示失败 200 表示成功
-func execute(dic:Dictionary={},ignore_before_execute:bool=false)->int:
+func execute(dic:Dictionary={},ignore_before_execute:bool=false)->Dictionary:
 	# 获取执行动作key，并将它记录到 statistics_map 中
 	var action_key=get_action_key(dic)
+	var can_do=can_do_decision(dic)
+	if !is_success(can_do):
+		GlobalInfo.statistics_map[action_key]=GlobalInfo.statistics_map.get(action_key,0)
+		return can_do
 	if !ignore_before_execute:
-		if _before_execute(dic)==Result.FAILURE:
+		var before_re=_before_execute(dic)
+		if !DecisionEntity.is_success(before_re):
 			GlobalInfo.statistics_map[action_key]=GlobalInfo.statistics_map.get(action_key,0)
-			return Result.FAILURE
+			return before_re
 	var re= _execute(dic)
 	if action_key!="":
-		if re==Result.SUCCESS:
+		if DecisionEntity.is_success(re):
 			GlobalInfo.statistics_map[action_key]=GlobalInfo.statistics_map.get(action_key,0)+1
 		else:
 			GlobalInfo.statistics_map[action_key]=GlobalInfo.statistics_map.get(action_key,0)
Index: obj/GlobalInfo.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/GlobalInfo.gd b/obj/GlobalInfo.gd
--- a/obj/GlobalInfo.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/GlobalInfo.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -36,7 +36,12 @@
 ## 死亡，移除人
 static func remove_people(target:People):
 	if GlobalInfo.place_map.has(target.place_id):
-		GlobalInfo.place_map.get(target.place_id).outgoing(target)
+		var p=GlobalInfo.place_map.get(target.place_id)
+		# 人物死亡后，将当前人物的修为转移给大地，当前大地随机升级0~人物等级次
+		for i in randi_range(0,target.lv.current):
+			p.do_update()
+		p.outgoing(target)
+
 	GlobalInfo.people_map.erase(target.id)
 	# 在statistics_map中key为死亡人数+1
 	statistics_map["死亡人数"]+=1
Index: obj/people/decision/修炼.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/修炼.gd b/obj/people/decision/修炼.gd
--- a/obj/people/decision/修炼.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/修炼.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -1,34 +1,44 @@
 class_name PracticeDecision
 extends DecisionEntity
 
+func can_do_decision(dic:Dictionary={})->Dictionary:
+	if !dic.has("people"):
+		Log.err("参数错误")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var people=dic.get("people")
+	if people.lingqi_absorb_cool_times>0:
+		return DecisionEntity.Error("我的灵气还没有消化完，不能再吸收了")
+	# 如果当前所在地没有灵气，不修炼
+	if GlobalInfo.place_map[people.place_id].current_lin_qi.current<=0:
+		return DecisionEntity.Error("当前所在地没有灵气")
+	return DecisionEntity.Success()
+
 func get_action_key(dic:Dictionary={})->String:
 	return "修炼"
 
 func _after_execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	people.action_cool_times=people.action_cool_time.get_current()
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
-	if people.lingqi_absorb_cool_times>0:
-		return Result.FAILURE
-	if ObjectUtils.probability(50):
-		return Result.SUCCESS
 	# 如果怀孕了则进行修炼
 	if people.is_pregnancy():
-		return Result.SUCCESS
-	return Result.FAILURE
+		return DecisionEntity.Success()
+	if ObjectUtils.probability(95):
+		return DecisionEntity.Success()
+	return DecisionEntity.Error("我不想修炼")
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	# 修炼
 	if people.lingqi.get_current()>=people.lingqi.max_v:
@@ -36,8 +46,8 @@
 		if people.can_update():
 			# 升级
 			people.do_update()
-			return Result.SUCCESS
+			return DecisionEntity.Success()
+		return DecisionEntity.Error("我不想修炼")
 	else:
 		people.xiu_lian()
-		return Result.SUCCESS
-	return Result.FAILURE
+		return DecisionEntity.Success()
Index: obj/people/decision/怀孕.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/怀孕.gd b/obj/people/decision/怀孕.gd
--- a/obj/people/decision/怀孕.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/怀孕.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -6,32 +6,34 @@
 	return "怀孕"
 
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	if people.is_pregnancy():
-		return Result.FAILURE
+		return DecisionEntity.Error("已经怀孕了，怎么还能再怀孕呢？")
 	if people.is_man:
-		return Result.FAILURE
-	return _calculate_pregnancy_probability(people)
+		return DecisionEntity.Error("我是男性，怎么怀孕你告诉我！")
+	if _calculate_pregnancy_probability(people):
+		return DecisionEntity.Success()
+	return DecisionEntity.Error("运气不好，没有怀孕成功")
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 
 	people.pregnancy.current=1;
 	# 生产孩子胚胎
 	people.pregnancy_people=_generate_new_child(target_people,people)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func _after_execute(dic:Dictionary={}):
 	pass
Index: obj/people/decision/恢复.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/恢复.gd b/obj/people/decision/恢复.gd
--- a/obj/people/decision/恢复.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/恢复.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -4,30 +4,30 @@
 func get_action_key(dic:Dictionary={})->String:
 	return "恢复"
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	var recovery_rate=(people.hp.max_v-people.hp.get_current())/people.hp.max_v*100
 	if ObjectUtils.probability(recovery_rate):
-		return Result.SUCCESS
+		return DecisionEntity.Success()
 	# 如果已经怀孕，则生命值不满时就恢复
 	if people.is_pregnancy() && people.hp.get_current()<people.hp.max_v:
-		return Result.SUCCESS
-	return Result.FAILURE
+		return DecisionEntity.Success()
+	return DecisionEntity.Error("不想恢复")
 
 func _after_execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	people.action_cool_times=people.action_cool_time.get_current()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	people.recover()
-	return Result.SUCCESS
+	return DecisionEntity.Success()
Index: obj/people/decision/流产.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/流产.gd b/obj/people/decision/流产.gd
--- a/obj/people/decision/流产.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/流产.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -4,21 +4,30 @@
 func get_action_key(dic:Dictionary={})->String:
 	return "流产"
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	if !people.is_pregnancy():
-		return Result.FAILURE
-	return calculate_abortion_probability(people)
+		return DecisionEntity.Error("我都没有怀孕，怎么流产！")
+	if calculate_abortion_probability(people):
+		return DecisionEntity.Success("我流产了")
+	else:
+		return DecisionEntity.Error("我没有流产")
 
 func _after_execute(dic:Dictionary={}):
 	pass
 
-func _execute(dic:Dictionary={})->int:
-	# todo 流产了，执行流产动作
-	return Result.SUCCESS
+func _execute(dic:Dictionary={})->Dictionary:
+	if !dic.has("people"):
+		Log.err("参数错误")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var people:People=dic.get("people")
+	people.pregnancy.current=0
+	ObjectUtils.free_obj(people.pregnancy_people)
+	people.pregnancy_people=null;
+	return DecisionEntity.Success()
 
 
 # 计算是否流产成功
Index: obj/people/decision/生产孩子.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/生产孩子.gd b/obj/people/decision/生产孩子.gd
--- a/obj/people/decision/生产孩子.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/生产孩子.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -5,29 +5,29 @@
 func get_action_key(dic:Dictionary={})->String:
 	return "生产孩子"
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	if !people.is_pregnancy():
-		return Result.FAILURE
-	return Result.SUCCESS
+		return DecisionEntity.Error("我都没有怀孕，怎么生孩子")
+	return DecisionEntity.Success()
 
 func _after_execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	people.action_cool_times=people.action_cool_time.get_current()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	_生产孩子(people)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func _生产孩子(people:People):
 	if !people.is_pregnancy():
@@ -48,5 +48,6 @@
 	place.enter(people.pregnancy_people)
 	# 将孩子加入到 GlobalInfo.people_map 中
 	GlobalInfo.people_map[people.pregnancy_people.id]=people.pregnancy_people
+	people.pregnancy.current=0
 	people.pregnancy_people=null
 	pass
Index: obj/people/decision/社交/交好.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好.gd b/obj/people/decision/社交/交好.gd
--- a/obj/people/decision/社交/交好.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交好.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -6,22 +6,24 @@
 var becomeLoverDecision:BecomeLoverDecision=BecomeLoverDecision.new()
 var marriageDecision:MarriageDecision=MarriageDecision.new()
 var mateDecision:MateDecision=MateDecision.new()
+var friendlyDecision:FriendlyDecision=FriendlyDecision.new()
+var argumentDecision:ArgumentDecision=ArgumentDecision.new()
 
 func get_action_key(dic:Dictionary={})->String:
 	return "交好"
 
-func _before_execute(dic:Dictionary={})->int:
-	return Result.SUCCESS
+func _before_execute(dic:Dictionary={})->Dictionary:
+	return DecisionEntity.Success()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	Log.debug(people.name_str+" 与 "+target_people.name_str+" 交好 ")
 	var weight_1={
@@ -107,17 +109,13 @@
 	Log.debug(people.name_str+"执行动作"+action,weight_1)
 	match action:
 		"问好":
-			## 增加关系值
-			people.add_relation(target_people)
-			return Result.SUCCESS
+			return friendlyDecision.execute(dic)
 		"论道":
-			## 增加关系值
-			people.add_relation(target_people,randi_range(-5,10))
-			return Result.SUCCESS
+			return argumentDecision.execute(dic)
 		"切磋":
 			## todo 战斗切磋
 			people.add_relation(target_people,randi_range(-3,6))
-			return Result.SUCCESS
+			return DecisionEntity.Success()
 		#"送礼":
 			#pass
 		"双修":
@@ -132,16 +130,16 @@
 			return mateDecision.execute(dic)
 		_:
 			Log.err("没有开发这个操作",action)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func _after_execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	people.action_cool_times=people.action_cool_time.get_current()
Index: obj/people/decision/社交/交好/交配.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/交配.gd b/obj/people/decision/社交/交好/交配.gd
--- a/obj/people/decision/社交/交好/交配.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交好/交配.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -9,60 +9,60 @@
 	return "交配"
 
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 如果说target_people是ai 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
-		return Result.FAILURE
+		return DecisionEntity.Error("对象是玩家")
 	
 	# 15岁以下，越小越不愿意交配
 	if target_people.get_age("year")<15 && ObjectUtils.probability(target_people.get_age("year"),15):
 		# 对方拒绝了
-		return Result.FAILURE
+		return DecisionEntity.Error("我还太小了，我不愿意")
 	# 对方如果怀孕了，模拟流产概率计算，如果流产了则不进行校验
 	if target_people.is_pregnancy():
 		if AbortionDecision.calculate_abortion_probability(target_people) || ObjectUtils.probability(80,100):
 			# 对方拒绝了
-			return Result.FAILURE
-	return Result.SUCCESS
+			return DecisionEntity.Error("我怀孕中，不想那个~")
+	return DecisionEntity.Success()
 
 
 func _execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	people.add_relation(target_people,randi_range(-2,10))
 	if target_people.is_man==people.is_man:
-		return Result.SUCCESS
+		return DecisionEntity.Success()
 
 	# 如果 people 或者 target_people 怀孕则进行流产概率计算，如果触发流产则进行流产方法调用
 	if people.is_pregnancy():
-		if abortion_decision.execute(dic)==Result.SUCCESS:
-			return Result.SUCCESS
+		if DecisionEntity.is_success(abortion_decision.execute(dic)):
+			return DecisionEntity.Success()
 	if target_people.is_pregnancy():
-		if abortion_decision.execute(dic)==Result.SUCCESS:
-			return Result.SUCCESS
+		if DecisionEntity.is_success(abortion_decision.execute(dic)):
+			return DecisionEntity.Success()
 	
 	if !target_people.is_man:
 		return pregnancy_decision.execute(dic)
 	elif !people.is_man:
 		return pregnancy_decision.execute(dic)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func _after_execute(dic:Dictionary={}):
 	pass
Index: obj/people/decision/社交/交好/双修.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/双修.gd b/obj/people/decision/社交/交好/双修.gd
--- a/obj/people/decision/社交/交好/双修.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交好/双修.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -3,41 +3,41 @@
 
 var abortion_decision:AbortionDecision=AbortionDecision.new()
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
-	var target_people=dic.get("target_people")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var target_people:People=dic.get("target_people")
 	# 如果说target_people是玩家 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
-		return Result.FAILURE
+		return DecisionEntity.Error("对象是玩家")
 	
 	# 15岁以下，越小越不愿意交配
-	if ObjectUtils.probability(target_people.get_age("year"),15):
+	if target_people.get_age("year")<15 && ObjectUtils.probability(target_people.get_age("year"),15):
 		# 对方拒绝了
-		return Result.FAILURE
+		return DecisionEntity.Error("我还太小了，我不愿意")
 	# 对方如果怀孕了，模拟流产概率计算，如果流产了则不进行校验
 	if target_people.is_pregnancy():
 		if AbortionDecision.calculate_abortion_probability(target_people) || ObjectUtils.probability(70,100):
 			# 对方拒绝了
-			return Result.FAILURE
-	return Result.SUCCESS
+			return DecisionEntity.Error("我怀孕中，不想那个~")
+	return DecisionEntity.Success()
 	
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 相互之间提升对方当前灵气值的 5%~15%
 	var lingqi_percentage = randf_range(0.05, 0.15) * people.lingqi.get_current()
@@ -49,7 +49,7 @@
 		abortion_decision.execute(dic)
 	if target_people.is_pregnancy():
 		abortion_decision.execute(dic)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func get_action_key(dic:Dictionary={})->String:
 	return "双修"
Index: obj/people/decision/社交/交好/成为道侣.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/成为道侣.gd b/obj/people/decision/社交/交好/成为道侣.gd
--- a/obj/people/decision/社交/交好/成为道侣.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交好/成为道侣.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -1,34 +1,34 @@
 class_name BecomeLoverDecision
 extends DecisionEntity
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 15岁以下不能成为道侣
 	if target_people.get_age("year")<15:
-		return Result.FAILURE
+		return DecisionEntity.Error("我还太小了，我不愿意")
 	# 如果说target_people是ai 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
-		return Result.FAILURE
-	return Result.SUCCESS
+		return DecisionEntity.Error("对象是玩家")
+	return DecisionEntity.Success()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 道侣一个新人，道侣列表中的所有人之前关系-20
 	for id in people.lover_list:
@@ -40,7 +40,7 @@
 	people.lover_list.append(target_people.id)
 	target_people.lover_list.append(people.id)
 	people.add_relation(target_people,randi_range(10,30))
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func get_action_key(dic:Dictionary={})->String:
 	return "成为道侣"
Index: obj/people/decision/社交/交好/拜师.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/拜师.gd b/obj/people/decision/社交/交好/拜师.gd
--- a/obj/people/decision/社交/交好/拜师.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交好/拜师.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -1,31 +1,31 @@
 class_name BecomeTeacherDecision
 extends DecisionEntity
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 如果说target_people是玩家 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
-		return Result.FAILURE
-	return Result.SUCCESS
+		return DecisionEntity.Error("对象是玩家")
+	return DecisionEntity.Success()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 如果已经有师傅了，还是要拜师 则原来师傅将对你-100仇恨
 	if people.shi_fu != "" and people.shi_fu != target_people.id:
@@ -40,7 +40,7 @@
 	# 更新师傅ID
 	people.shi_fu = target_people.id
 	people.add_relation(target_people,randi_range(5,20))
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func get_action_key(dic:Dictionary={})->String:
 	return "拜师"
Index: obj/people/decision/社交/交好/结婚.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/结婚.gd b/obj/people/decision/社交/交好/结婚.gd
--- a/obj/people/decision/社交/交好/结婚.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交好/结婚.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -2,37 +2,37 @@
 extends DecisionEntity
 
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 18岁以下不能结婚
 	if target_people.get_age("year")<18:
-		return Result.FAILURE
+		return DecisionEntity.Error("我还太小了，我不愿意")
 	# 如果target_people是玩家 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
-		return Result.FAILURE
+		return DecisionEntity.Error("对象是玩家")
 	# 如果target_people是同性 则返回失败
 	if target_people.is_man==people.is_man:
-		return Result.FAILURE
-	return Result.SUCCESS
+		return DecisionEntity.Error("有没有搞错，我不是同性恋！")
+	return DecisionEntity.Success()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 结婚一个新人，结婚列表中的所有人之前关系-50
 	for id in people.wife_list:
@@ -44,7 +44,7 @@
 	people.wife_list.append(target_people.id)
 	target_people.wife_list.append(people.id)
 	people.add_relation(target_people,randi_range(20,40))
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func get_action_key(dic:Dictionary={})->String:
 	return "结婚"
Index: obj/people/decision/社交/交好/论道.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/论道.gd b/obj/people/decision/社交/交好/论道.gd
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/obj/people/decision/社交/交好/论道.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,28 @@
+class_name ArgumentDecision
+extends DecisionEntity
+
+
+func _before_execute(dic:Dictionary={})->Dictionary:
+	return DecisionEntity.Success()
+
+func _execute(dic:Dictionary={})->Dictionary:
+	if !dic.has("people"):
+		Log.err("参数错误")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var people=dic.get("people")
+	
+	if !dic.has("target_people"):
+		Log.err("参数错误")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var target_people=dic.get("target_people")
+	
+	## 增加关系值
+	people.add_relation(target_people,randi_range(-5,10))
+	target_people.add_relation(people,randi_range(-5,10))
+	return DecisionEntity.Success()
+
+func get_action_key(dic:Dictionary={})->String:
+	return "论道"
+
+func _after_execute(dic:Dictionary={}):
+	pass
Index: obj/people/decision/社交/交好/问好.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/问好.gd b/obj/people/decision/社交/交好/问好.gd
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/obj/people/decision/社交/交好/问好.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,28 @@
+class_name FriendlyDecision
+extends DecisionEntity
+
+
+func _before_execute(dic:Dictionary={})->Dictionary:
+	return DecisionEntity.Success()
+
+func _execute(dic:Dictionary={})->Dictionary:
+	if !dic.has("people"):
+		Log.err("参数错误")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var people=dic.get("people")
+	
+	if !dic.has("target_people"):
+		Log.err("参数错误")
+		return DecisionEntity.ErrorCode(-1,"参数错误")
+	var target_people=dic.get("target_people")
+	
+	## 增加关系值
+	people.add_relation(target_people)
+	target_people.add_relation(people)
+	return DecisionEntity.Success()
+
+func get_action_key(dic:Dictionary={})->String:
+	return "问好"
+
+func _after_execute(dic:Dictionary={}):
+	pass
Index: obj/people/decision/社交/交恶.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交恶.gd b/obj/people/decision/社交/交恶.gd
--- a/obj/people/decision/社交/交恶.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交恶.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -7,35 +7,35 @@
 	return "交恶"
 
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 不能欺负10岁以下的人
 	if target_people.get_age("year")<10:
-		return Result.FAILURE
-	return Result.SUCCESS
+		return DecisionEntity.Error()
+	return DecisionEntity.Success()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	Log.debug(people.name_str+" 与 "+target_people.name_str+" 交恶 ")
 	var weight_1={
 		"攻击":GlobalInfo.people_map.values().size(),
-		"辱骂":GlobalInfo.game_setting["最大人口数"],
+		"辱骂":GlobalInfo.game_setting["最大人口数"]/2,
 		#"偷窃":10,
 		# "脱离师徒关系":10,
 		# "脱离道侣关系":10,
@@ -49,19 +49,19 @@
 			return attackBehaviorDecision.execute(dic)
 		"辱骂":
 			people.add_relation(target_people,randi_range(-10,1))
-			return Result.SUCCESS
+			return DecisionEntity.Success()
 		_:
 			Log.err("没有开发这个操作",action)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func _after_execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	people.action_cool_times=people.action_cool_time.get_current()
Index: obj/people/decision/社交/交恶/攻击行为.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交恶/攻击行为.gd b/obj/people/decision/社交/交恶/攻击行为.gd
--- a/obj/people/decision/社交/交恶/攻击行为.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/交恶/攻击行为.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -2,21 +2,21 @@
 extends DecisionEntity
 
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 如果target_people是玩家 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
-		return Result.FAILURE
-	return Result.SUCCESS
+		return DecisionEntity.Error("对象是玩家")
+	return DecisionEntity.Success()
 
 # 判断是否需要逃跑
 static func need_escape(people:People)->bool:
@@ -36,15 +36,15 @@
 		Log.debug(people.name_str+"不需要逃跑")
 		return false
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	# 调用self和target的集气速度
 	var self_speed=people.attack_speed.get_current()
@@ -59,7 +59,7 @@
 			# 如果需要逃跑
 			if need_escape(people):
 				Log.debug(people.name_str+"选择逃跑")
-				return Result.SUCCESS
+				return DecisionEntity.Success()
 			else:
 				people.do_attack(target_people)
 				# 重置self_speed
@@ -68,7 +68,7 @@
 			# 如果需要逃跑
 			if need_escape(target_people):
 				Log.debug(target_people.name_str+"选择逃跑")
-				return Result.SUCCESS
+				return DecisionEntity.Success()
 			else:
 				target_people.do_attack(people)
 				# 重置target_speed
@@ -82,7 +82,7 @@
 	# 如果target_people的生命值小于0，则战斗胜利
 	if target_people.hp.get_current()<=0:
 		people._after_beat(people)
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func get_action_key(dic:Dictionary={})->String:
 	return "攻击行为"
Index: obj/people/decision/社交/社交.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/社交.gd b/obj/people/decision/社交/社交.gd
--- a/obj/people/decision/社交/社交.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/社交/社交.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -7,45 +7,45 @@
 func get_action_key(dic:Dictionary={})->String:
 	return "社交"
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	
 	# 怀孕大概率不社交 规避风险
 	if people.is_pregnancy():
 		if ObjectUtils.probability(80,100):
-			return Result.FAILURE
+			return DecisionEntity.Error("我怀孕中")
 		
 	if GlobalInfo.place_map.is_empty():
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var place:Place=GlobalInfo.place_map[people.place_id]
 	# 随机选择一个人
 	var target_people_list=place.get_other_people_id_list(people.id)
 	if target_people_list.is_empty():
-		return Result.FAILURE
+			return DecisionEntity.Error("当前所在地空无一人")
 	var target_id=target_people_list.pick_random()
 	var target_people=GlobalInfo.get_people_by_id(target_id)
 	if target_people==null:
 		# 表示这个人死亡了不进行操作了
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"这可能是个死人")
 	dic["target_people"]=target_people
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 		
 	if !dic.has("target_people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var target_people=dic.get("target_people")
 	
 	var weight_1={
-		"交好":GlobalInfo.game_setting["最大人口数"],
+		"交好":GlobalInfo.game_setting["最大人口数"]/2,
 		"交恶":GlobalInfo.people_map.values().size(),
 	}
 	if people.relation.has(target_people.id):
@@ -62,7 +62,7 @@
 		"交恶":
 			return socialBadDecision.execute(dic)
 			
-	return Result.FAILURE
+	return DecisionEntity.Error("我不能进行该操作")
 
 func _after_execute(dic:Dictionary={}):
-	return Result.SUCCESS
+	return DecisionEntity.Success()
Index: obj/people/decision/移动.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/移动.gd b/obj/people/decision/移动.gd
--- a/obj/people/decision/移动.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/decision/移动.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -4,31 +4,31 @@
 func get_action_key(dic:Dictionary={})->String:
 	return "移动"
 
-func _before_execute(dic:Dictionary={})->int:
+func _before_execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	if people.is_pregnancy():
 		# 如果怀孕了，当前地方人越多，就大概移动
 		if ObjectUtils.probability(1,people.current_place().get_all_people().size()):
-			return Result.FAILURE
-		return Result.SUCCESS
+			return DecisionEntity.Error("这里人太多了，我怀孕想去人少的地方")
+		return DecisionEntity.Success()
 	elif ObjectUtils.probability(randi_range(50,90)):
-		return Result.SUCCESS
-	return Result.FAILURE
+		return DecisionEntity.Success()
+	return DecisionEntity.Error("不想移动")
 
-func _execute(dic:Dictionary={})->int:
+func _execute(dic:Dictionary={})->Dictionary:
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	people.move_to(GlobalInfo.place_map.values().pick_random())
-	return Result.SUCCESS
+	return DecisionEntity.Success()
 
 func _after_execute(dic:Dictionary={}):
 	if !dic.has("people"):
 		Log.err("参数错误")
-		return Result.FAILURE
+		return DecisionEntity.ErrorCode(-1,"参数错误")
 	var people=dic.get("people")
 	people.action_cool_times=people.action_cool_time.get_current()
Index: obj/people/people.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/people.gd b/obj/people/people.gd
--- a/obj/people/people.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/people.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -69,6 +69,8 @@
 	if is_dead():
 		if is_player:
 			# todo 游戏结束
+			print("死亡了")
+			GlobalInfo.is_pause=true
 			return
 		GlobalInfo.remove_people(self)
 		return
@@ -80,7 +82,8 @@
 			return
 		else:
 			# 概率流产计算
-			if GlobalInfo.abortion_decision.execute({"people":self})==DecisionEntity.Result.SUCCESS:
+			var re=GlobalInfo.abortion_decision.execute({"people":self})
+			if DecisionEntity.is_success(re):
 				action_cool_times=action_cool_time.get_current()
 			return
 			pass
@@ -92,17 +95,17 @@
 	if is_player:
 		return
 	# 恢复
-	if GlobalInfo.recovery_decision.execute({"people":self})==DecisionEntity.Result.SUCCESS:
+	if DecisionEntity.is_success(GlobalInfo.recovery_decision.execute({"people":self})):
 		return
 	## 修炼判断
-	if GlobalInfo.practice_decision.execute({"people":self})==DecisionEntity.Result.SUCCESS:
+	if DecisionEntity.is_success(GlobalInfo.practice_decision.execute({"people":self})):
 		return
 	## 社交
-	if GlobalInfo.social_decision.execute({"people":self})==DecisionEntity.Result.SUCCESS:
+	if DecisionEntity.is_success(GlobalInfo.social_decision.execute({"people":self})):
 		return
 	# 还可以在此地留传承 接受传承
 	## 随机50~90的概率进行移动
-	if GlobalInfo.move_decision.execute({"people":self})==DecisionEntity.Result.SUCCESS:
+	if DecisionEntity.is_success(GlobalInfo.move_decision.execute({"people":self})):
 		return
 	# 什么都不做
 	pass
@@ -117,19 +120,19 @@
 	
 	# 通过概率计算工具ObjectUtils.probability计算是否击杀他人
 	# print(GlobalInfo.people_map.values().size(),GlobalInfo.game_setting["最大人口数"])
-	if ObjectUtils.probability(GlobalInfo.people_map.values().size(),GlobalInfo.game_setting["最大人口数"]):
+	#if ObjectUtils.probability(GlobalInfo.people_map.values().size(),GlobalInfo.game_setting["最大人口数"]):
 		# 记录日志
-		Log.debug("击杀他人",{
-			"source":self.name_str,
-			"target":target.name_str,
-			"source_id":self.id,
-			"target_id":target.id,
-		})
-		# 击杀他人
-		kill(target)
-	else:
-		target.hp.current=1
-	pass
+	Log.debug("击杀他人",{
+		"source":self.name_str,
+		"target":target.name_str,
+		"source_id":self.id,
+		"target_id":target.id,
+	})
+	# 击杀他人
+	kill(target)
+	#else:
+		#target.hp.current=1
+	#pass
 
 
 # 判断是否怀孕
@@ -204,9 +207,10 @@
 
 ## 修炼
 func xiu_lian():
+	# 重置时间
 	lingqi_absorb_cool_times=lingqi_absorb_cool_time.get_current()
 	#Log.debug("修炼")
-	lingqi.add_current(lingqi_absorb.get_current())
+	lingqi.add_current(GlobalInfo.place_map[self.place_id].lingqi_absorbed(lingqi_absorb.get_current()))
 	pass
 
 ## 执行升级
Index: obj/people/people.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/people.json b/obj/people/people.json
--- a/obj/people/people.json	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/people/people.json	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -73,8 +73,8 @@
 		"min_growth": 0,
 		"name_str": "吸收灵气冷却时间",
 		"score": 0,
-		"max_v": 300,
-		"min_v": 280
+		"max_v": 120,
+		"min_v": 60
 	},
 	"lingqi_absorb_cool_times": 0,
 	"lv": {
@@ -92,12 +92,12 @@
 		"current": 0,
 		"filename": "res://obj/properties/random_propertie.gd",
 		"growth_factor": -1,
-		"max_growth": 1,
-		"min_growth": 3,
+		"max_growth": 2,
+		"min_growth": 0,
 		"name_str": "动作速度",
 		"score": 0,
-		"max_v": 100,
-		"min_v": 120
+		"max_v": 200,
+		"min_v": 20
 	},
 	"max_life": {
 		"current": 0,
Index: obj/place/place.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/place/place.gd b/obj/place/place.gd
--- a/obj/place/place.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/place/place.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -26,6 +26,24 @@
 	product_speeding_times=product_speeding.get_current()
 	current_lin_qi.add_current(product_value.get_current())
 
+## 灵气被吸收
+func lingqi_absorbed(num:float)->float:
+	var re=minf(current_lin_qi.current,num)
+	current_lin_qi.add_current(-num);
+	return re;
+		
+
+## 执行升级
+func do_update():
+	Log.debug("升级")
+	var up_field_list=[
+		"current_lin_qi","product_speeding","product_value"
+	]
+	for i in up_field_list:
+		self[i].do_growth()
+	pass
+	
+	
 func save_json():
 	var re:Dictionary={}
 	re.merge({
Index: obj/place/place.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/place/place.json b/obj/place/place.json
--- a/obj/place/place.json	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/obj/place/place.json	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -6,22 +6,22 @@
 	"people_id_list": [],
 	"product_speeding_times": 0.0,
 	"current_lin_qi": {
-		"current": 500.0,
+		"current": 50.0,
 		"filename": "res://obj/properties/bar_propertie.gd",
 		"growth_factor": 1.0,
 		"max_growth": 100.0,
 		"min_growth": 50.0,
-		"max_v": 1000.0,
+		"max_v": 50.0,
 		"min_v": 0.0,
 		"name_str": "灵气",
 		"score": 0.0
 	},
 	"product_speeding": {
 		"filename": "res://obj/properties/random_propertie.gd",
-		"min_v": 10.0,
-		"max_v": 60.0,
-		"min_growth": 1.0,
-		"max_growth": 5.0,
+		"min_v": 150.0,
+		"max_v": 300.0,
+		"min_growth": 0.0,
+		"max_growth": 3.0,
 		"growth_factor": -1.0,
 		"name_str": "生产速度",
 		"current": 0.0,
@@ -29,9 +29,9 @@
 	},
 	"product_value": {
 		"filename": "res://obj/properties/random_propertie.gd",
-		"min_v": 10.0,
-		"max_v": 100.0,
-		"min_growth": 1.0,
+		"min_v": 0.0,
+		"max_v": 50.0,
+		"min_growth": 0.0,
 		"max_growth": 5.0,
 		"growth_factor": 1.0,
 		"name_str": "生产量",
Index: ui/core/地图内容/地图内容.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/core/地图内容/地图内容.gd b/ui/core/地图内容/地图内容.gd
--- a/ui/core/地图内容/地图内容.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/core/地图内容/地图内容.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -50,9 +50,12 @@
 
 
 func _on_修炼_pressed() -> void:
-	GlobalInfo.player.xiu_lian()
-	$"VBoxContainer/HBoxContainer/VBoxContainer/操作/修炼".init(func(): return maxi(GlobalInfo.player.action_cool_times,GlobalInfo.player.lingqi_absorb_cool_times))
-	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
+	var re=PracticeDecision.new().execute({"people":GlobalInfo.player},true)
+	if DecisionEntity.is_success(re):
+		$"VBoxContainer/HBoxContainer/VBoxContainer/操作/修炼".init(func(): return maxi(GlobalInfo.player.action_cool_times,GlobalInfo.player.lingqi_absorb_cool_times))
+	else:
+		pass
+		#print("修炼失败",re)
 	pass # Replace with function body.
 
 
Index: ui/core/地图内容/地图内容.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/core/地图内容/地图内容.tscn b/ui/core/地图内容/地图内容.tscn
--- a/ui/core/地图内容/地图内容.tscn	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/core/地图内容/地图内容.tscn	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -75,5 +75,8 @@
 layout_mode = 2
 size_flags_horizontal = 1
 
+[node name="年龄" type="Label" parent="."]
+layout_mode = 2
+
 [connection signal="pressed" from="VBoxContainer/HBoxContainer/VBoxContainer/操作/修炼" to="." method="_on_修炼_pressed"]
 [connection signal="pressed" from="VBoxContainer/HBoxContainer/VBoxContainer/操作/升级" to="." method="_on_升级_pressed"]
Index: ui/core/战斗界面/战斗界面.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/core/战斗界面/战斗界面.gd b/ui/core/战斗界面/战斗界面.gd
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/ui/core/战斗界面/战斗界面.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,7 @@
+extends PanelContainer
+
+func _process(delta: float) -> void:
+	pass
+				
+func init(place:Place):
+	pass
Index: ui/core/战斗界面/战斗界面.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/core/战斗界面/战斗界面.tscn b/ui/core/战斗界面/战斗界面.tscn
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/ui/core/战斗界面/战斗界面.tscn	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,17 @@
+[gd_scene load_steps=2 format=3 uid="uid://bh58wwtdxvjqh"]
+
+[ext_resource type="Script" path="res://ui/core/战斗界面/战斗界面.gd" id="1_2oo8s"]
+
+[node name="战斗界面" type="PanelContainer"]
+offset_right = 1143.0
+offset_bottom = 645.0
+size_flags_horizontal = 3
+size_flags_vertical = 3
+script = ExtResource("1_2oo8s")
+
+[node name="GridContainer" type="GridContainer" parent="."]
+layout_mode = 2
+
+[node name="Button" type="Button" parent="GridContainer"]
+layout_mode = 2
+text = "技能与操作"
Index: ui/others/BarPropertieTscn/bar_propertie_tscn.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/others/BarPropertieTscn/bar_propertie_tscn.gd b/ui/others/BarPropertieTscn/bar_propertie_tscn.gd
--- a/ui/others/BarPropertieTscn/bar_propertie_tscn.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/others/BarPropertieTscn/bar_propertie_tscn.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -1,3 +1,4 @@
+@icon("res://asserts/组件图片/进度条.png")
 extends HBoxContainer
 
 @export var 名称:String=""
@@ -6,7 +7,7 @@
 
 func _process(delta: float) -> void:
 	$Label.text=名称
-	if propertie:
+	if is_instance_valid(propertie):
 		$ProgressBar.max_value=propertie.max_v
 		$ProgressBar.min_value=propertie.min_v
 		$ProgressBar.value=propertie.get_current()
Index: ui/others/RandomPropertieTscn/random_propertie_tscn.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/others/RandomPropertieTscn/random_propertie_tscn.gd b/ui/others/RandomPropertieTscn/random_propertie_tscn.gd
--- a/ui/others/RandomPropertieTscn/random_propertie_tscn.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/others/RandomPropertieTscn/random_propertie_tscn.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -1,3 +1,4 @@
+@icon("res://asserts/组件图片/范围.png")
 extends HBoxContainer
 
 @export var 名称:String=""
@@ -5,5 +6,5 @@
 
 func _process(delta: float) -> void:
 	$Label.text=名称
-	if propertie:
+	if is_instance_valid(propertie):
 		$value.text="%.1f~%.1f"%[propertie.min_v,propertie.max_v]
Index: ui/tips/人员点击tips/人员点击tips.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/tips/人员点击tips/人员点击tips.gd b/ui/tips/人员点击tips/人员点击tips.gd
--- a/ui/tips/人员点击tips/人员点击tips.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/tips/人员点击tips/人员点击tips.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -3,23 +3,130 @@
 var target_people:People
 
 func init(target_people:People):
-	# 点击人员就得暂停，防止人立刻了还能继续操作
-	GlobalInfo.is_pause=true
 	self.target_people=target_people
 	$"人物详情".init(target_people)
+	$"操作/双修".init(func(): return GlobalInfo.player.action_cool_times)
+	$"操作/拜师".init(func(): return GlobalInfo.player.action_cool_times)
+	$"操作/问好".init(func(): return GlobalInfo.player.action_cool_times)
+	$"操作/道侣".init(func(): return GlobalInfo.player.action_cool_times)
+	$"操作/结婚".init(func(): return GlobalInfo.player.action_cool_times)
+	$"操作/交配".init(func(): return GlobalInfo.player.action_cool_times)
 	pass
 
 
 func _on_双修_pressed() -> void:
+	if !is_instance_valid(target_people):
+		print("对方已经死亡了")
+		return
+	if target_people.place_id!=GlobalInfo.player.place_id:
+		print("对方已经离开")
+		return
 	var d={"people":GlobalInfo.player,"target_people":target_people}
 	var decision=DoubleXiuDecision.new()
-	if decision._before_execute(d)==DecisionEntity.Result.SUCCESS:
+	var re=decision._before_execute(d)
+	if DecisionEntity.is_success(re):
 		decision.execute(d,true)
 	else:
 		# 不愿意的结果
+		print(re)
 		pass
 	
 	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
 	$"操作/双修".init(func(): return GlobalInfo.player.action_cool_times)
+	pass # Replace with function body.
+
+
+func _on_拜师_pressed() -> void:
+	if target_people.place_id!=GlobalInfo.player.place_id:
+		print("对方已经离开")
+		return
+	var d={"people":GlobalInfo.player,"target_people":target_people}
+	var decision=BecomeTeacherDecision.new()
+	var re=decision._before_execute(d)
+	if DecisionEntity.is_success(re):
+		decision.execute(d,true)
+	else:
+		# 不愿意的结果
+		print(re)
+		pass
+	
+	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
+	$"操作/拜师".init(func(): return GlobalInfo.player.action_cool_times)
+	pass # Replace with function body.
+
+
+func _on_问好_pressed() -> void:
+	if target_people.place_id!=GlobalInfo.player.place_id:
+		print("对方已经离开")
+		return
+	var d={"people":GlobalInfo.player,"target_people":target_people}
+	var decision=FriendlyDecision.new()
+	var re=decision._before_execute(d)
+	if DecisionEntity.is_success(re):
+		decision.execute(d,true)
+	else:
+		# 不愿意的结果
+		print(re)
+		pass
+	
+	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
+	$"操作/问好".init(func(): return GlobalInfo.player.action_cool_times)
+	pass # Replace with function body.
+
+
+func _on_道侣_pressed() -> void:
+	if target_people.place_id!=GlobalInfo.player.place_id:
+		print("对方已经离开")
+		return
+	var d={"people":GlobalInfo.player,"target_people":target_people}
+	var decision=BecomeLoverDecision.new()
+	var re=decision._before_execute(d)
+	if DecisionEntity.is_success(re):
+		decision.execute(d,true)
+	else:
+		# 不愿意的结果
+		print(re)
+		pass
+	
+	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
+	$"操作/道侣".init(func(): return GlobalInfo.player.action_cool_times)
 	GlobalInfo.is_pause=false
 	pass # Replace with function body.
+
+
+func _on_结婚_pressed() -> void:
+	if target_people.place_id!=GlobalInfo.player.place_id:
+		print("对方已经离开")
+		return
+	var d={"people":GlobalInfo.player,"target_people":target_people}
+	var decision=MarriageDecision.new()
+	var re=decision._before_execute(d)
+	if DecisionEntity.is_success(re):
+		decision.execute(d,true)
+	else:
+		# 不愿意的结果
+		print(re)
+		pass
+	
+	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
+	$"操作/结婚".init(func(): return GlobalInfo.player.action_cool_times)
+	pass # Replace with function body.
+
+
+func _on_交配_pressed() -> void:
+	if target_people.place_id!=GlobalInfo.player.place_id:
+		print("对方已经离开")
+		return
+	var d={"people":GlobalInfo.player,"target_people":target_people}
+	var decision=MateDecision.new()
+	var re=decision._before_execute(d)
+	if DecisionEntity.is_success(re):
+		decision.execute(d,true)
+	else:
+		# 不愿意的结果
+		print(re)
+		pass
+	
+	GlobalInfo.player.action_cool_times=GlobalInfo.player.action_cool_time.get_current()
+	$"操作/交配".init(func(): return GlobalInfo.player.action_cool_times)
+	pass # Replace with function body.
Index: ui/tips/人员点击tips/人员点击tips.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/tips/人员点击tips/人员点击tips.tscn b/ui/tips/人员点击tips/人员点击tips.tscn
--- a/ui/tips/人员点击tips/人员点击tips.tscn	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/tips/人员点击tips/人员点击tips.tscn	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -66,3 +66,8 @@
 game_pause_can_click = true
 
 [connection signal="pressed" from="操作/双修" to="." method="_on_双修_pressed"]
+[connection signal="pressed" from="操作/拜师" to="." method="_on_拜师_pressed"]
+[connection signal="pressed" from="操作/问好" to="." method="_on_问好_pressed"]
+[connection signal="pressed" from="操作/道侣" to="." method="_on_道侣_pressed"]
+[connection signal="pressed" from="操作/结婚" to="." method="_on_结婚_pressed"]
+[connection signal="pressed" from="操作/交配" to="." method="_on_交配_pressed"]
Index: ui/人物详情/人物详情.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/人物详情/人物详情.gd b/ui/人物详情/人物详情.gd
--- a/ui/人物详情/人物详情.gd	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/人物详情/人物详情.gd	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -3,8 +3,7 @@
 @export var people:People
 
 func _process(delta: float) -> void:
-	if people:
-		$人物名称.text = people.name_str
+	if is_instance_valid(people):
 		$人物等级.text = "等级：" + str(people.lv.current)
 		$年龄.text = "年龄：%s岁" % str(people.get_age("year"))
 		$寿命.propertie.current=people.get_age()
@@ -12,7 +11,11 @@
 
 func init(people:People):
 	self.people=people
-	$寿命.propertie=people.max_life
+	$人物名称.text = people.name_str
+	if people.is_man: 
+		$"性别".text="性别：男" 
+	else: 
+		$"性别".text="性别：女" 
 	$寿命.propertie=people.max_life
 	$灵气值.propertie=people.lingqi
 	$吸收灵气量.propertie=people.lingqi_absorb
@@ -23,4 +26,5 @@
 	$集气速度.propertie=people.attack_speed
 	$逃跑概率.propertie=people.fight_escape_probability
 	$怀孕周期.propertie=people.pregnancy
+	$"动作速度".propertie=people.action_cool_time
 	pass
Index: ui/人物详情/人物详情.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/人物详情/人物详情.tscn b/ui/人物详情/人物详情.tscn
--- a/ui/人物详情/人物详情.tscn	(revision fd6c50a78081a347f8251c1136ad35c45dd76a41)
+++ b/ui/人物详情/人物详情.tscn	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -21,6 +21,10 @@
 [node name="年龄" type="Label" parent="."]
 layout_mode = 2
 
+[node name="性别" type="Label" parent="."]
+layout_mode = 2
+text = "性别"
+
 [node name="寿命" parent="." instance=ExtResource("1_1i8yk")]
 layout_mode = 2
 "名称" = "寿命"
@@ -60,3 +64,7 @@
 [node name="怀孕周期" parent="." instance=ExtResource("1_1i8yk")]
 layout_mode = 2
 "名称" = "怀孕周期"
+
+[node name="动作速度" parent="." instance=ExtResource("2_egbrg")]
+layout_mode = 2
+"名称" = "动作速度"
Index: 数据.csv
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/数据.csv b/数据.csv
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/数据.csv	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,2 @@
+����,�ȼ�
+1,2
Index: 数据.csv.import
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/数据.csv.import b/数据.csv.import
new file mode 100644
--- /dev/null	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
+++ b/数据.csv.import	(revision 68c36d7d80e3d2c3550aa03df56e87e3a71c0fe5)
@@ -0,0 +1,15 @@
+[remap]
+
+importer="csv_translation"
+type="Translation"
+uid="uid://oqnpc424ghxf"
+valid=false
+
+[deps]
+
+source_file="res://数据.csv"
+
+[params]
+
+compress=true
+delimiter=0
diff --git a/asserts/组件图片/范围.png b/asserts/组件图片/范围.png
new file mode 100644
index 0000000000000000000000000000000000000000..5b0444e2e02d3b7cd72fe6bd022cd548ceb05318
GIT binary patch
literal 717
zc$@*v0y6!HP)<h;3K|Lk000e1NJLTq001!n000;W1^@s6Q$H2r00001b5ch_0Itp)
z=>Px%he<?1R9HvFmpzCSK@f$%Ma(p~^pXn%GXwFWOY|~xHPB2WV-<uu#J@lgjYSPK
zQcy58^aRB~4nx7n<SsN(Fw}X=_EMD9KRY|S4s5VJ)m`;o)vM|m@$YjhSksbU&)Mw&
z`q}4H=FB0McSgY}e}XjywdvLc;$~ngI}ajfI|PW4KzNqkWkB2x*v)~krUDd!@aMGx
z@;=8P7Rge|VC2JBK~$c8O#uAb6oh3VVpqYu52%W4J;QR^0>YQE&S?hWV_TLc6rjz9
zCnPF2#TI75gNQUCo1ulBGSsSt)FHDVaxKtznOPiK+o+u6(`Lexr%ZVNCrg=l09<tu
zegoFK^`F7URxpXRrD)<j@S@Q3#ZsSvm6*<fu%%JcgtAi1#8F@uIOKp_10HspBM?5_
zk(O#8W+6wKEP_z%zJ;n2>;o4HAQF?xQXddDyK`$orL^jVCSXFYCzpwNLD<C4Jtrh;
ziQ7KEfD>INB=ALm5CJw5UUN}rOjj5i=Xhf4$(4gj>E!}J<Zi;b?ibCLDTu?sN8p&-
zEm2F{wM?7?UIm^@!miB;1uUIftrS7X{}JF|@cU2!k?Szefr}GheddJrr~_K9=zn;N
zm7fE^XW+PF^D%I_0wTI=-Rl~~6X5&6AnpP;T#VCl+L)A+uZT;)vxai2P4K>%P{}31
z{{S8V+c^+dCPU4>|2^qWU;i_R6qBk#n%&BQcnzF&FYPC3P1r+Z!Vf$7_t)_|xpG<o
zzI0`?<|4TdT(1nfmRoM^^EA?wCna?`4PQS`#+o<{ybY*41H37KsIjm2rO(rr{WY6U
zz()GUPR3#-p?(VNneI|Mur#3h+<;sBjVs|Vwqds!fmdUe00000NkvXXu0mjfg<eUK

diff --git a/asserts/组件图片/进度条.png b/asserts/组件图片/进度条.png
new file mode 100644
index 0000000000000000000000000000000000000000..a13fb402740b07581de68e346c95750b241f445a
GIT binary patch
literal 430
zc$@*Q0a5;mP)<h;3K|Lk000e1NJLTq000;O000;W1^@s6;CDUv00001b5ch_0Itp)
z=>Px$Xh}ptR7gwhls`zrKop1XC8U8uA%laoL&t#7L6cktq5kXW)WONc(QXPthqOJ~
zQtIF)D$Z^e3+m+P;LxLsSQmA0b#e$!xjapWOwtpiAedY4-S2z%J??-^dBK$PNdk}>
zP89tiMU1gI05}VRU|!nR<bpmT?zP+Pm#Az!<S1NK)tg){H)EQno=T;B$8j>l;cz_+
z!*fJjQxs){i0=TfZQJ(AcZ^1(krhHz0bo^C)eXkj;}}q@)hg+9x?3uhGGi)0#kTEZ
z&iO+ahCSDH8Rz^E5wn!ivh0Rmd2dnQtyb$O1{j9XEf$LzM7*VxE)52QEdZ$czHjNe
zKC5Zk6Cy5BO7DIEcqN4F$ACzY5Mop)6i7awFT1YW=bV2iin3{0)&=MMk`VIjIL@vt
zyk4*GAfhLPSm|^+_whsXJa1Xkw1XfB7Gxok{c8X?Z8n=%@sNKRIPrM$RY>h7ivEG3
YPv$~_88Yb}CjbBd07*qoM6N<$f+Z=x)Bpeg

