Index: addons/GDExcelExporter/.keep
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/addons/GDExcelExporter/.keep b/addons/GDExcelExporter/.keep
--- a/addons/GDExcelExporter/.keep	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/addons/GDExcelExporter/.keep	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,1 +1,0 @@
-这是excel的一个插件，可以将你的excel转换为godot中的脚本或者json，然后用于数据的处理
\ No newline at end of file
Index: main.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.gd b/main.gd
--- a/main.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/main.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -11,6 +11,10 @@
 	pass
 
 func _process(delta: float) -> void:
+	if GlobalInfo.is_pause:
+		$"HBoxContainer/玩家信息/VBoxContainer/相关按钮/暂停".text="继续"
+	else:
+		$"HBoxContainer/玩家信息/VBoxContainer/相关按钮/暂停".text="暂停"
 	pass
 
 # 切换tips
@@ -89,10 +93,8 @@
 
 func _on_暂停_pressed() -> void:
 	GlobalInfo.is_pause=!GlobalInfo.is_pause
-	if GlobalInfo.is_pause:
-		$"HBoxContainer/玩家信息/VBoxContainer/相关按钮/暂停".text="继续"
-	else:
-		$"HBoxContainer/玩家信息/VBoxContainer/相关按钮/暂停".text="暂停"
+	if !GlobalInfo.is_pause:
+		$"HBoxContainer/tips/人员点击tips".hide()
 	pass # Replace with function body.
 
 
Index: main.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/main.tscn b/main.tscn
--- a/main.tscn	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/main.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,15 +1,22 @@
-[gd_scene load_steps=8 format=3 uid="uid://cqi0vduabab5i"]
+[gd_scene load_steps=10 format=3 uid="uid://cqi0vduabab5i"]
 
 [ext_resource type="Script" path="res://main.gd" id="1_ig7tw"]
 [ext_resource type="PackedScene" uid="uid://cdewsuqswvjmv" path="res://ui/others/游戏时间/游戏时间.tscn" id="2_hc0md"]
 [ext_resource type="PackedScene" uid="uid://duns6b76maa2a" path="res://ui/tips/地图点击tips/地图点击tips.tscn" id="2_jl8uk"]
 [ext_resource type="PackedScene" uid="uid://dekyku5jukbs2" path="res://ui/人物详情/人物详情.tscn" id="3_hb7c7"]
 [ext_resource type="PackedScene" uid="uid://dlkk8ls71gbkh" path="res://ui/地图/地图.tscn" id="4_quw5l"]
-[ext_resource type="PackedScene" uid="uid://clfwwieoue705" path="res://ui/core/地图内容/地图内容.tscn" id="5_fmg3q"]
+[ext_resource type="PackedScene" uid="uid://bh58wwtdxvjqh" path="res://ui/core/地图内容/地图内容.tscn" id="5_fmg3q"]
+[ext_resource type="PackedScene" uid="uid://032gjitbhijh" path="res://ui/tips/人员点击tips/人员点击tips.tscn" id="7_i4727"]
 
 [sub_resource type="StyleBoxFlat" id="StyleBoxFlat_kwkk2"]
 content_margin_left = 60.0
 content_margin_top = 20.0
+
+[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_bfejm"]
+content_margin_left = 20.0
+content_margin_top = 20.0
+content_margin_right = 20.0
+content_margin_bottom = 20.0
 
 [node name="Main" type="Node2D"]
 script = ExtResource("1_ig7tw")
@@ -74,6 +81,7 @@
 
 [node name="地图内容" parent="HBoxContainer/core" instance=ExtResource("5_fmg3q")]
 layout_mode = 2
+theme_override_styles/panel = SubResource("StyleBoxFlat_bfejm")
 
 [node name="tips" type="ScrollContainer" parent="HBoxContainer"]
 custom_minimum_size = Vector2(160, 0)
@@ -86,12 +94,11 @@
 [node name="空tips" type="Control" parent="HBoxContainer/tips"]
 layout_mode = 2
 
-[node name="人员点击tips" type="VBoxContainer" parent="HBoxContainer/tips"]
+[node name="人员点击tips" parent="HBoxContainer/tips" instance=ExtResource("7_i4727")]
+visible = false
 layout_mode = 2
-
-[node name="Label" type="Label" parent="HBoxContainer/tips/人员点击tips"]
-layout_mode = 2
-text = "人员点击tips"
+size_flags_horizontal = 3
+size_flags_vertical = 3
 
 [node name="people_list" type="SubViewport" parent="."]
 
Index: obj/people/People.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/People.tscn b/obj/people/People.tscn
--- a/obj/people/People.tscn	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/People.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,6 +1,6 @@
 [gd_scene load_steps=2 format=3 uid="uid://bjwxrif5lufsp"]
 
-[ext_resource type="Script" uid="uid://c665fql2sl6h8" path="res://obj/people/people.gd" id="1_1wru1"]
+[ext_resource type="Script" path="res://obj/people/people.gd" id="1_1wru1"]
 
 [node name="People" type="Node"]
 script = ExtResource("1_1wru1")
Index: obj/people/decision/修炼.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/修炼.gd b/obj/people/decision/修炼.gd
--- a/obj/people/decision/修炼.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/decision/修炼.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -14,9 +14,11 @@
 
 func _before_execute()->int:
 	if people.lingqi_absorb_cool_times>0:
-		people.lingqi_absorb_cool_times-=1
 		return Result.FAILURE
 	if ObjectUtils.probability(50):
+		return Result.SUCCESS
+	# 如果怀孕了则进行修炼
+	if people.is_pregnancy():
 		return Result.SUCCESS
 	return Result.FAILURE
 
Index: obj/people/decision/恢复.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/恢复.gd b/obj/people/decision/恢复.gd
--- a/obj/people/decision/恢复.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/decision/恢复.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -13,6 +13,9 @@
 	var recovery_rate=(people.hp.max_v-people.hp.get_current())/people.hp.max_v*100
 	if ObjectUtils.probability(recovery_rate):
 		return Result.SUCCESS
+	# 如果已经怀孕，则生命值不满时就恢复
+	if people.is_pregnancy() && people.hp.get_current()<people.hp.max_v:
+		return Result.SUCCESS
 	return Result.FAILURE
 
 func _after_execute():
Index: obj/people/decision/流产.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/流产.gd b/obj/people/decision/流产.gd
new file mode 100644
--- /dev/null	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
+++ b/obj/people/decision/流产.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -0,0 +1,55 @@
+class_name AbortionDecision
+extends DecisionEntity
+
+@onready var people:People
+
+func _init(people:People):
+	self.people=people
+
+func get_action_key()->String:
+	return "流产"
+
+func _before_execute()->int:
+	if !people.is_pregnancy():
+		return Result.FAILURE
+	return calculate_abortion_probability(people)
+
+func _after_execute():
+	pass
+
+func _execute()->int:
+	# todo 流产了，执行流产动作
+	return Result.SUCCESS
+
+
+# 计算是否流产成功
+static func calculate_abortion_probability(people:People)->bool:
+	# 基础流产概率
+	var base_probability = 0
+	# 根据怀孕次数增加流产概率
+	var pregnancy_count_factor = min(people.pregnancy_times / people.MAX_PREGNANCY_COUNT, 1.0) * 0.003
+	# 如果怀孕周期小于100天 那么随着天数增加概率流产
+	var pregnancy_weeks_factor = 0
+	if people.pregnancy.get_current()<=people.pregnancy.max_v/2:
+		pregnancy_weeks_factor=min(people.pregnancy.get_current() / people.pregnancy.max_v, 1.0) * 0.001
+	else:
+		# 否则概率为随时间增加为-概率（趋于稳定）
+		pregnancy_weeks_factor=-(people.pregnancy.get_current()-people.pregnancy.max_v/2)/people.pregnancy.max_v * 0.001
+	# 根据年龄增加流产概率
+	var age_factor = min(people.get_age() / people.max_life.max_v, 1.0) * 0.002
+	# 计算最终流产概率
+	var total_probability = base_probability + pregnancy_count_factor + pregnancy_weeks_factor + age_factor
+	# 确保概率不超过 1.0
+	if ObjectUtils.probability(min(total_probability, 1.0)*100):
+		Log.dbg("流产概率计算信息：",{
+		"怀孕次数":people.pregnancy_times,
+		"怀孕次数产生概率":people.pregnancy_count_factor,
+		"怀孕周期":people.pregnancy.get_current(),
+		"怀孕周期产生概率":people.pregnancy_weeks_factor,
+		"年龄":people.get_age(),
+		"最大年龄":people.max_life.max_v,
+		"年龄产生概率":age_factor,
+		"总概率":total_probability,
+		})
+		return true
+	return false
Index: obj/people/decision/生产孩子.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/生产孩子.gd b/obj/people/decision/生产孩子.gd
new file mode 100644
--- /dev/null	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
+++ b/obj/people/decision/生产孩子.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -0,0 +1,44 @@
+class_name ProduceChildrenDecision
+extends DecisionEntity
+
+@onready var people:People
+
+func _init(people:People):
+	self.people=people
+
+func get_action_key()->String:
+	return "生产孩子"
+
+func _before_execute()->int:
+	if !people.is_pregnancy():
+		return Result.FAILURE
+	return Result.SUCCESS
+
+func _after_execute():
+	people.action_cool_times=people.action_cool_time.get_current()
+
+func _execute()->int:
+	_生产孩子(people)
+	return Result.SUCCESS
+
+func _生产孩子(people:People):
+	if !people.is_pregnancy():
+		return
+	# 如果 pregnancy_people 存在表示有怀孩子，否则直接返回
+	
+	# 难产概率判定，pregnancy.current 越远离 pregnancy.max_v 越概率难产
+	if !ObjectUtils.probability(people.pregnancy.get_current(),people.pregnancy.max_v):
+		# 难产了
+		# 1.孩子丢失 pregnancy_people 丢失
+		# 2.随机扣除生命值（0，hp.max_v/2）的随机值
+		pass
+	
+	# 孩子出生成功。设置孩子属性
+	people.pregnancy_people.birth=GlobalInfo.game_time
+	# 孩子进入母亲所在地
+	var place:Place=GlobalInfo.place_map[self.place_id]
+	place.enter(people.pregnancy_people)
+	# 将孩子加入到 GlobalInfo.people_map 中
+	GlobalInfo.people_map[people.pregnancy_people.id]=people.pregnancy_people
+	people.pregnancy_people=null
+	pass
Index: obj/people/decision/社交/交好/交配.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/交配.gd b/obj/people/decision/社交/交好/交配.gd
--- a/obj/people/decision/社交/交好/交配.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/decision/社交/交好/交配.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -12,27 +12,71 @@
 	self.target_people=target_people
 
 func _before_execute()->int:
-	# 15岁以下不能交配
-	if target_people.get_age("year")<15:
-		return Result.FAILURE
 	# 如果说target_people是ai 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
 		return Result.FAILURE
+	
+	# 15岁以下，越小越不愿意交配
+	if ObjectUtils.probability(target_people.get_age("year"),15):
+		# 对方拒绝了
+		return Result.FAILURE
+	# 对方如果怀孕了，模拟流产概率计算，如果流产了则不进行校验
+	if target_people.is_pregnancy():
+		if AbortionDecision.calculate_abortion_probability(target_people) || ObjectUtils.probability(80,100):
+			# 对方拒绝了
+			return Result.FAILURE
 	return Result.SUCCESS
 
 
 func _execute():
 	people.add_relation(target_people,randi_range(-2,10))
+	# 如果 people 或者 target_people 怀孕则进行流产概率计算，如果触发流产则进行流产方法调用
+	if people.is_pregnancy():
+		if AbortionDecision.new(people).execute()==Result.SUCCESS:
+			return Result.SUCCESS
+	if target_people.is_pregnancy():
+		if AbortionDecision.new(target_people).execute()==Result.SUCCESS:
+			return Result.SUCCESS
+	
 	if target_people.is_man==people.is_man:
 		return Result.SUCCESS
 	if !target_people.is_man:
-		if target_people._calculate_pregnancy_probability():
+		if _calculate_pregnancy_probability(target_people):
 			target_people.pregnancy.current=1;
-	elif people.is_man:
-		if target_people._calculate_pregnancy_probability():
-			target_people.pregnancy.current=1;
+			# 生产孩子胚胎
+	elif !people.is_man:
+		if _calculate_pregnancy_probability(people):
+			people.pregnancy.current=1;
+			# 生产孩子胚胎
 	return Result.SUCCESS
 
 func _after_execute():
 	pass
+
+## 生成新小孩
+func _生成新的小孩():
+	pass
+
+# 计算是否怀孕成功
+func _calculate_pregnancy_probability(people:People)->bool:
+	# 基础怀孕率
+	var pregnancy_probabilty=0.5;
+	var age_probabilty=0;
+	if people.get_age()<13*365:
+	# 如果年龄小于13岁 年龄越小 越不可能
+		age_probabilty=min(1,people.get_age()/people.max_life.max_v)
+	else:
+	# 否则年龄越大，越不可能
+		age_probabilty=min(1,1-people.get_age()/people.max_life.max_v)
+		# 健康度判断(这个是负向概率，越健康越小)
+	var hp_probabilty=1-people.hp.get_current()/people.hp.max_v
+	var total_probability=min(1,(pregnancy_probabilty+age_probabilty-hp_probabilty))*100
+	Log.dbg("怀孕概率计算信息：",{
+			"年龄":people.get_age(),
+			"最大年龄":people.max_life.max_v,
+			"年龄产生概率":age_probabilty,
+		   "健康度":hp_probabilty,
+		   "总概率":total_probability
+			})
+	return ObjectUtils.probability(total_probability);
Index: obj/people/decision/社交/交好/双修.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/交好/双修.gd b/obj/people/decision/社交/交好/双修.gd
--- a/obj/people/decision/社交/交好/双修.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/decision/社交/交好/双修.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -9,13 +9,20 @@
 	self.target_people=target_people
 
 func _before_execute()->int:
-	# 15岁以下不能双修
-	if target_people.get_age("year")<15:
-		return Result.FAILURE
 	# 如果说target_people是玩家 则加入到GlobalInfo.ai_interaction_queue队列中
 	if target_people.is_player:
 		GlobalInfo.ai_interaction_queue.append(self)
 		return Result.FAILURE
+	
+	# 15岁以下，越小越不愿意交配
+	if ObjectUtils.probability(target_people.get_age("year"),15):
+		# 对方拒绝了
+		return Result.FAILURE
+	# 对方如果怀孕了，模拟流产概率计算，如果流产了则不进行校验
+	if target_people.is_pregnancy():
+		if AbortionDecision.calculate_abortion_probability(target_people) || ObjectUtils.probability(70,100):
+			# 对方拒绝了
+			return Result.FAILURE
 	return Result.SUCCESS
 
 func _execute()->int:
@@ -23,6 +30,12 @@
 	var lingqi_percentage = randf_range(0.05, 0.15) * people.lingqi.get_current()
 	target_people.lingqi.add_current(lingqi_percentage)
 	people.lingqi.add_current(lingqi_percentage)
+	
+	# 如果 people 或者 target_people 怀孕则进行流产概率计算，如果触发流产则进行流产方法调用
+	if people.is_pregnancy():
+		AbortionDecision.new(people).execute()
+	if target_people.is_pregnancy():
+		AbortionDecision.new(target_people).execute()
 	return Result.SUCCESS
 
 func get_action_key()->String:
@@ -30,9 +43,3 @@
 
 func _after_execute():
 	pass
-
-
-
-
-
-
Index: obj/people/decision/社交/社交.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/社交/社交.gd b/obj/people/decision/社交/社交.gd
--- a/obj/people/decision/社交/社交.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/decision/社交/社交.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -11,6 +11,11 @@
 	return "社交"
 
 func _before_execute()->int:
+	# 怀孕大概率不社交 规避风险
+	if people.is_pregnancy():
+		if ObjectUtils.probability(80,100):
+			return Result.FAILURE
+		
 	if GlobalInfo.place_map.is_empty():
 		return Result.FAILURE
 	var place:Place=GlobalInfo.place_map[people.place_id]
Index: obj/people/decision/移动.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/decision/移动.gd b/obj/people/decision/移动.gd
--- a/obj/people/decision/移动.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/decision/移动.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -10,7 +10,12 @@
 	return "移动"
 
 func _before_execute()->int:
-	if ObjectUtils.probability(randi_range(50,90)):
+	if people.is_pregnancy():
+		# 如果怀孕了，当前地方人越多，就大概移动
+		if ObjectUtils.probability(1,people.current_place().get_all_people().size()):
+			return Result.FAILURE
+		return Result.SUCCESS
+	elif ObjectUtils.probability(randi_range(50,90)):
 		return Result.SUCCESS
 	return Result.FAILURE
 
Index: obj/people/people.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/people/people.gd b/obj/people/people.gd
--- a/obj/people/people.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/people/people.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -67,6 +67,7 @@
 var practice_decision:PracticeDecision
 var social_decision:SocialDecision
 var move_decision:MoveDecision
+var abortion_decision:AbortionDecision
 
 func do_action():
 	# 年龄计算
@@ -80,20 +81,21 @@
 	if is_pregnancy():
 		pregnancy.add_current(1)
 		if pregnancy.get_current()>=pregnancy.max_v:
-			# 每次生产新的人类就往statistics_map中的key为出生人数+1
-			GlobalInfo.statistics_map["出生人数"]+=1
-			# todo 生产
-			action_cool_times=action_cool_time.get_current()
+			ProduceChildrenDecision.new(self).execute()
 			return
 		else:
 			# 概率流产计算
-			if _calculate_abortion_probability():
+			if abortion_decision==null:
+				abortion_decision=AbortionDecision.new(self)
+			if abortion_decision.execute()==DecisionEntity.Result.SUCCESS:
 				action_cool_times=action_cool_time.get_current()
-				return
+			return
 			pass
 	if action_cool_times>0:
 		action_cool_times-=1
 		return
+	if lingqi_absorb_cool_times>0:
+		lingqi_absorb_cool_times-=1
 	if is_player:
 		return
 	# 恢复
@@ -119,271 +121,6 @@
 		return
 	# 什么都不做
 	pass
-	
-	
-func _社交()->bool:
-	if GlobalInfo.place_map.is_empty():
-		return false
-	var place:Place=GlobalInfo.place_map[place_id]
-	# 随机选择一个人
-	var target_people_list=place.get_other_people_id_list(id)
-	if target_people_list.is_empty():
-		return false
-	# 如果target_people_list.pick_random()的随机一个不在relation中，则重新选择
-	var target_id=target_people_list.pick_random()
-	if !GlobalInfo.people_map.has(target_id):
-		# 这里出错了，打印错误信息
-		Log.err("社交时，target_id:%s不存在"%target_id,GlobalInfo.people_map)
-		return _社交()
-	var target_people:People=GlobalInfo.get_people_by_id(target_id)
-	if target_people==null:
-		return false
-	var weight_1={
-		"交好":GlobalInfo.game_setting["最大人口数"],
-		"交恶":GlobalInfo.people_map.values().size(),
-	}
-	if relation.has(target_people.id):
-		var re=relation.get(target_people.id)
-		if re.relation_value>0:
-			weight_1["交好"]+=re.relation_value
-		else:
-			weight_1["交恶"]-=re.relation_value
-	var temp=ObjectUtils.weight_selector({
-		_交好.bind(target_people):weight_1["交好"],
-		_交恶.bind(target_people):weight_1["交恶"],
-		# _什么都不做.bind(target_people):weight_1["什么都不做"],
-	})
-	return temp[0].call()
-func _修炼()->bool:
-	if lingqi_absorb_cool_times>0:
-		lingqi_absorb_cool_times-=1
-		return false
-	if ObjectUtils.probability(50):
-		# 修炼
-		if lingqi.get_current()>=lingqi.max_v:
-			# 不能吸收灵力了
-			if can_update():
-				# 升级
-				do_update()
-				return true
-		else:
-			xiu_lian()
-			return true
-	return false
-func _恢复()->bool:
-	var 恢复占比=(hp.max_v-hp.get_current())/hp.max_v*100
-	if ObjectUtils.probability(恢复占比):
-		#Log.debug("恢复")
-		recover()
-		return true
-	return false
-func _交好(target_people:People)->bool:
-	Log.debug(str_format("{name_str} 与 %s 交好 "%target_people.name_str))
-	var weight_1={
-		"问好":70,
-		"论道":50,
-		"切磋":30,
-		#待开发"送礼":10,
-		"双修":10,
-		"拜师":10,
-		"成为道侣":10,
-		"结婚":10,
-		"交配":10,
-	}
-	# 特殊关系影响
-	match target_people.id:
-		shi_fu:
-			weight_1["问好"]+=50
-			weight_1["双修"]-=10
-			weight_1["拜师"]-=1
-			weight_1["成为道侣"]-=10
-			weight_1["结婚"]-=10
-		father:
-			weight_1["问好"]+=50
-			weight_1["双修"]-=10
-			weight_1["拜师"]-=1
-			weight_1["成为道侣"]-=10
-			weight_1["结婚"]-=10
-		mother:
-			weight_1["问好"]+=50
-			weight_1["双修"]-=10
-			weight_1["拜师"]-=1
-			weight_1["成为道侣"]-=10
-			weight_1["结婚"]-=10
-		child_list:
-			weight_1["切磋"]+=10
-			weight_1["双修"]-=10
-			weight_1["拜师"]-=1
-			weight_1["成为道侣"]-=10
-			weight_1["结婚"]-=10
-		wife_list:
-			weight_1["双修"]+=10
-			weight_1["交配"]+=30
-			weight_1["拜师"]-=1
-			weight_1["成为道侣"]-=10
-			weight_1["结婚"]-=10
-		lover_list:
-			weight_1["双修"]+=10
-			weight_1["交配"]+=20
-			weight_1["结婚"]+=10
-			weight_1["拜师"]-=1
-			weight_1["成为道侣"]-=10
-		_:
-			# 没有深度关系
-			pass
-	# 关系值影响
-	if relation.has(target_people.id):
-		var re:Relation=relation.get(target_people.id)
-		weight_1["问好"]+=re.relation_value*0.1
-		weight_1["论道"]+=re.relation_value*0.1
-		weight_1["切磋"]+=re.relation_value*0.1
-		weight_1["双修"]+=re.relation_value*0.5
-		weight_1["拜师"]+=re.relation_value*0.1
-		weight_1["成为道侣"]+=re.relation_value*0.4
-		weight_1["结婚"]+=re.relation_value*0.3
-		weight_1["交配"]+=re.relation_value*0.2
-	# 怀孕了不能做
-	if !target_people.is_man:
-		if target_people.pregnancy.get_current()>0:
-			weight_1["交配"]-=10
-			weight_1["双修"]-=10
-	if !self.is_man:
-		if self.pregnancy.get_current()>0:
-			weight_1["交配"]-=10
-			weight_1["双修"]-=10
-	# 如果是同性，双修=0 成为道侣=0 结婚=0 交配=0
-	if target_people.is_man==is_man:
-		weight_1["交配"]-=10
-		weight_1["双修"]-=10
-		weight_1["成为道侣"]-=10
-		weight_1["结婚"]-=10
-	
-	var action=ObjectUtils.weight_selector(weight_1)[0]
-	Log.debug(str_format("{name_str}执行动作%s"%action),weight_1)
-	match action:
-		"问好":
-			## 增加关系值
-			add_relation(target_people)
-			return true
-		"论道":
-			## 增加关系值
-			add_relation(target_people,randi_range(-5,10))
-			return true
-		"切磋":
-			## todo 战斗切磋
-			add_relation(target_people,randi_range(-3,6))
-			return true
-		#"送礼":
-			#pass
-		"双修":
-			# 相互之间提升对方当前灵气值的 5%~15%
-			var lingqi_percentage = randf_range(0.05, 0.15) * lingqi.get_current()
-			target_people.lingqi.add_current(lingqi_percentage)
-			lingqi.add_current(lingqi_percentage)
-			# 增加关系值
-			add_relation(target_people,randi_range(-1,14))
-			return true
-		"拜师":
-			# 如果已经有师傅了，还是要拜师 则原来师傅将对你-100仇恨
-			if shi_fu != "" and shi_fu != target_people.id:
-				var old_master:People = GlobalInfo.get_people_by_id(shi_fu)
-				if old_master==null:
-					# 师傅已经死亡了
-					pass
-				else:
-					add_relation(old_master, -100)
-			# 增加关系值
-			add_relation(target_people, randi_range(5,20))
-			# 更新师傅ID
-			shi_fu = target_people.id
-			add_relation(target_people,randi_range(5,20))
-			return true
-		"成为道侣":
-			# 道侣一个新人，道侣列表中的所有人之前关系-20
-			for id in lover_list:
-				var other:People = GlobalInfo.get_people_by_id(id)
-				if other==null:
-					# 对方已经死亡了
-					continue
-				add_relation(other, -20)
-			lover_list.append(target_people.id)
-			target_people.lover_list.append(self.id)
-			add_relation(target_people,randi_range(10,30))
-			return true
-		"结婚":
-			# 结婚一个新人，结婚列表中的所有人之前关系-50
-			for id in wife_list:
-				var other:People = GlobalInfo.get_people_by_id(id)
-				if other==null:
-					# 对方已经死亡了
-					continue
-				add_relation(other, -50)
-			wife_list.append(target_people.id)
-			target_people.wife_list.append(self.id)
-			add_relation(target_people,randi_range(20,40))
-			return true
-		"交配":
-			add_relation(target_people,randi_range(-2,10))
-			if target_people.is_man==is_man:
-				return true
-			if !target_people.is_man:
-				if target_people._calculate_pregnancy_probability():
-					target_people.pregnancy.current=1;
-			elif is_man:
-				if _calculate_pregnancy_probability():
-					pregnancy.current=1;
-			return true
-		_:
-			Log.err("没有开发这个操作",action)
-	return false
-func _交恶(target_people:People)->bool:
-	Log.debug(str_format("{name_str} 与 %s 交恶 "%target_people.name_str))
-	var weight_1={
-		"攻击":GlobalInfo.people_map.values().size(),
-		"辱骂":GlobalInfo.game_setting["最大人口数"],
-		#"偷窃":10,
-	}
-	# 使用ObjectUtils.weight_selector权重选择器对weight_1进行选择
-	var action=ObjectUtils.weight_selector(weight_1)[0]
-	Log.debug(str_format("{name_str}执行动作%s"%action),weight_1)
-	match action:
-		"攻击":
-			# 调用self和target的集气速度
-			var self_speed=attack_speed.get_current()
-			var target_speed=target_people.attack_speed.get_current()
-			while true:
-				# slef_speed-1
-				self_speed-=1
-				# target_speed-1
-				target_speed-=1
-				# 如果self_speed<=0 则self攻击target
-				if self_speed<=0:
-					do_attack(target_people)
-					# 重置self_speed
-					self_speed=attack_speed.get_current()
-				if target_speed<=0:
-					target_people.do_attack(self)
-					# 重置target_speed
-					target_speed=target_people.attack_speed.get_current()
-				# 如果self的生命值或者targbet的生命值小于0退出循环
-				if hp.get_current()<=0 or target_people.hp.get_current()<=0:
-					break
-			# 如果self的生命值小于0，则战斗失败
-			if hp.get_current()<=0:
-				target_people._after_beat(self)
-			# 如果target_people的生命值小于0，则战斗胜利
-			if target_people.hp.get_current()<=0:
-				_after_beat(target_people)
-			return true
-		"辱骂":
-			return true
-		_:
-			Log.err("没有开发这个操作",action)
-	return false
-
-# func _什么都不做(target_people:People):
-# 	Log.debug("什么都不做")
-# 	return false
 
 # 击败他人的后续策略动作方法
 func _after_beat(target:People):
@@ -412,61 +149,11 @@
 
 # 判断是否怀孕
 func is_pregnancy()->bool:
+	if !pregnancy_people:
+		return false
 	return pregnancy.get_current()>0
 
-# 计算是否怀孕成功
-func _calculate_pregnancy_probability()->bool:
-	# 基础怀孕率
-	var pregnancy_probabilty=0.5;
-	var age_probabilty=0;
-	if get_age()<13*365:
-	# 如果年龄小于13岁 年龄越小 越不可能
-		age_probabilty=min(1,get_age()/max_life.max_v)
-	else:
-	# 否则年龄越大，越不可能
-		age_probabilty=min(1,1-get_age()/max_life.max_v)
-	# 健康度判断(这个是负向概率，越健康越小)
-	var hp_probabilty=1-hp.get_current()/hp.max_v
-	var total_probability=min(1,(pregnancy_probabilty+age_probabilty-hp_probabilty))*100
-	Log.dbg("怀孕概率计算信息：",{
-		"年龄":get_age(),
-		"最大年龄":max_life.max_v,
-		"年龄产生概率":age_probabilty,
-		"健康度":hp_probabilty,
-		"总概率":total_probability
-	})
-	return ObjectUtils.probability(total_probability);
-# 计算是否流产成功
-func _calculate_abortion_probability()->bool:
-	# 基础流产概率
-	var base_probability = 0
-	# 根据怀孕次数增加流产概率
-	var pregnancy_count_factor = min(pregnancy_times / MAX_PREGNANCY_COUNT, 1.0) * 0.003
-	# 如果怀孕周期小于100天 那么随着天数增加概率流产
-	var pregnancy_weeks_factor = 0
-	if pregnancy.get_current()<=pregnancy.max_v/2:
-		pregnancy_weeks_factor=min(pregnancy.get_current() / pregnancy.max_v, 1.0) * 0.001
-	else:
-		# 否则概率为随时间增加为-概率（趋于稳定）
-		pregnancy_weeks_factor=-(pregnancy.get_current()-pregnancy.max_v/2)/pregnancy.max_v * 0.001
-	# 根据年龄增加流产概率
-	var age_factor = min(get_age() / max_life.max_v, 1.0) * 0.002
-	# 计算最终流产概率
-	var total_probability = base_probability + pregnancy_count_factor + pregnancy_weeks_factor + age_factor
-	# 确保概率不超过 1.0
-	if ObjectUtils.probability(min(total_probability, 1.0)*100):
-		Log.dbg("流产概率计算信息：",{
-		"怀孕次数":pregnancy_times,
-		"怀孕次数产生概率":pregnancy_count_factor,
-		"怀孕周期":pregnancy.get_current(),
-		"怀孕周期产生概率":pregnancy_weeks_factor,
-		"年龄":get_age(),
-		"最大年龄":max_life.max_v,
-		"年龄产生概率":age_factor,
-		"总概率":total_probability,
-		})
-		return true
-	return false
+
 
 ## 移动到其它地方
 func move_to(place:Place):
@@ -507,7 +194,6 @@
 func _init() -> void:
 	self.load_json(JSON.parse_string(FileAccess.open("res://obj/people/people.json",FileAccess.READ).get_as_text()))
 	id=uuid.v4()
-	#birth=GlobalInfo.game_time
 	pass
 
 func _ready() -> void:
@@ -672,6 +358,10 @@
 	# todo target情侣仇恨+25 父母+50 儿子+25
 	pass
 
+## 获得当前人员所在地对象
+func current_place()->Place:
+	return GlobalInfo.place_map[place_id]
+
 ## 日志输出辅助方法
 func str_format(msg:String)->String:
 	var data=save_json()
Index: obj/properties/growth_propertie.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/obj/properties/growth_propertie.tscn b/obj/properties/growth_propertie.tscn
--- a/obj/properties/growth_propertie.tscn	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/obj/properties/growth_propertie.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,7 +1,3 @@
-[gd_scene load_steps=2 format=3 uid="uid://ds03ubqcbsisa"]
-
-[sub_resource type="Resource" id="Resource_i63yj"]
-metadata/__load_path__ = "res://obj/properties/growth_propertie.gd"
+[gd_scene format=3 uid="uid://ds03ubqcbsisa"]
 
 [node name="GrowthPropertie" type="Node"]
-script = SubResource("Resource_i63yj")
Index: project.godot
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/project.godot b/project.godot
--- a/project.godot	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/project.godot	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -27,6 +27,8 @@
 Log="*res://addons/logger/logger.gd"
 uuid="*res://addons/uuid/uuid.gd"
 GlobalInfo="*res://obj/GlobalInfo.gd"
+BeehaveGlobalMetrics="*res://addons/beehave/metrics/beehave_global_metrics.gd"
+BeehaveGlobalDebugger="*res://addons/beehave/debug/global_debugger.gd"
 
 [display]
 
@@ -34,7 +36,7 @@
 
 [editor_plugins]
 
-enabled=PackedStringArray("res://addons/logger/plugin.cfg", "res://addons/uuid/plugin.cfg")
+enabled=PackedStringArray("res://addons/GDExcelExporter/plugin.cfg", "res://addons/beehave/plugin.cfg", "res://addons/logger/plugin.cfg", "res://addons/scene_manager/plugin.cfg", "res://addons/uuid/plugin.cfg")
 
 [rendering]
 
Index: ui/core/地图内容/地图内容.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/core/地图内容/地图内容.gd b/ui/core/地图内容/地图内容.gd
--- a/ui/core/地图内容/地图内容.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/ui/core/地图内容/地图内容.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,23 +1,37 @@
-extends VBoxContainer
+extends PanelContainer
 
 var place:Place
 var people_id_cache:Array=[]
 
 func _process(delta: float) -> void:
+	if GlobalInfo.is_pause:
+		return
 	if place:
 		# 如果缓存中的人员id与当前人员id不一致，则更新缓存
 		var new_people_id_cache:Array=place.get_all_people().map(func(i:People):return i.id)
 		# 比较new_people_id_cache和people_id_cache 如果有一个值不一样，则更新
 		if not ArrayUtls.is_equal(new_people_id_cache,people_id_cache):
 			update_people_list()
-
+	if GlobalInfo.player:
+		$"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".show()
+		$"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".init(func(): return GlobalInfo.player.action_cool_times)
+		if GlobalInfo.player.can_update():
+			if !$"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".visible:
+				$"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".show()
+				$"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".init(func(): return GlobalInfo.player.action_cool_times)
+				$"VBoxContainer/HBoxContainer/VBoxContainer/操作/修炼".disabled=true
+		else:
+			if $"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".visible:
+				$"VBoxContainer/HBoxContainer/VBoxContainer/操作/升级".hide()
+				
 func init(place:Place):
 	self.place=place
 	update_people_list()
-	$"HBoxContainer/地图详情".init(place)
+	$"VBoxContainer/HBoxContainer/地图详情".init(place)
 
 func update_people_list():
-	for i in $"HBoxContainer/VBoxContainer/VBoxContainer2/人员".get_children():
+	people_id_cache.clear()
+	for i in $"VBoxContainer/HBoxContainer/VBoxContainer/VBoxContainer2/人员".get_children():
 		i.free()
 	for i in place.get_all_people():
 		# 将人员id加入缓存
@@ -25,7 +39,7 @@
 		# 创建一个button
 		var button=Button.new()
 		button.text=i.name_str
-		$"HBoxContainer/VBoxContainer/VBoxContainer2/人员".add_child(button)
+		$"VBoxContainer/HBoxContainer/VBoxContainer/VBoxContainer2/人员".add_child(button)
 		# 绑定点击事件到change_tips
 		button.pressed.connect(_show_detail.bind(i))
 
@@ -33,3 +47,14 @@
 func _show_detail(people:People):
 	GlobalInfo.main_node.change_tips("人员点击tips",people)
 	pass
+
+
+func _on_修炼_pressed() -> void:
+	GlobalInfo.player.xiu_lian()
+	$"VBoxContainer/HBoxContainer/VBoxContainer/操作/修炼".init(func(): return maxi(GlobalInfo.player.action_cool_times,GlobalInfo.player.lingqi_absorb_cool_times))
+	pass # Replace with function body.
+
+
+func _on_升级_pressed() -> void:
+	GlobalInfo.player.do_update()
+	pass # Replace with function body.
Index: ui/core/地图内容/地图内容.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/core/地图内容/地图内容.tscn b/ui/core/地图内容/地图内容.tscn
--- a/ui/core/地图内容/地图内容.tscn	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/ui/core/地图内容/地图内容.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,61 +1,78 @@
-[gd_scene load_steps=3 format=3 uid="uid://clfwwieoue705"]
+[gd_scene load_steps=4 format=3 uid="uid://bh58wwtdxvjqh"]
 
+[ext_resource type="Script" path="res://ui/core/地图内容/地图内容.gd" id="1_4vgtn"]
 [ext_resource type="PackedScene" uid="uid://ca18mecieqdb8" path="res://ui/tips/地图点击tips/地图详情.tscn" id="1_21xrs"]
-[ext_resource type="Script" path="res://ui/core/地图内容/地图内容.gd" id="1_t27h5"]
+[ext_resource type="PackedScene" uid="uid://cwxnvif5krapq" path="res://ui/others/动作冷却按钮/动作冷却按钮.tscn" id="2_wxjyr"]
 
-[node name="地图内容" type="VBoxContainer"]
+[node name="地图内容" type="PanelContainer"]
 offset_right = 1143.0
 offset_bottom = 645.0
 size_flags_horizontal = 3
 size_flags_vertical = 3
-script = ExtResource("1_t27h5")
+script = ExtResource("1_4vgtn")
 
-[node name="HBoxContainer" type="HBoxContainer" parent="."]
+[node name="VBoxContainer" type="VBoxContainer" parent="."]
+layout_mode = 2
+
+[node name="HBoxContainer" type="HBoxContainer" parent="VBoxContainer"]
 layout_mode = 2
 size_flags_vertical = 3
 
-[node name="VBoxContainer" type="VBoxContainer" parent="HBoxContainer"]
+[node name="VBoxContainer" type="VBoxContainer" parent="VBoxContainer/HBoxContainer"]
 layout_mode = 2
 theme_override_constants/separation = 10
 
-[node name="VBoxContainer2" type="VBoxContainer" parent="HBoxContainer/VBoxContainer"]
+[node name="VBoxContainer2" type="VBoxContainer" parent="VBoxContainer/HBoxContainer/VBoxContainer"]
 layout_mode = 2
 
-[node name="所在地的人员信息" type="Label" parent="HBoxContainer/VBoxContainer/VBoxContainer2"]
+[node name="所在地的人员信息" type="Label" parent="VBoxContainer/HBoxContainer/VBoxContainer/VBoxContainer2"]
 layout_mode = 2
 text = "所在地的人员信息："
 
-[node name="人员" type="GridContainer" parent="HBoxContainer/VBoxContainer/VBoxContainer2"]
+[node name="人员" type="GridContainer" parent="VBoxContainer/HBoxContainer/VBoxContainer/VBoxContainer2"]
 custom_minimum_size = Vector2(0, 300)
 layout_mode = 2
 columns = 10
 
-[node name="探索信息" type="Label" parent="HBoxContainer/VBoxContainer/VBoxContainer2"]
+[node name="探索信息" type="Label" parent="VBoxContainer/HBoxContainer/VBoxContainer/VBoxContainer2"]
 layout_mode = 2
 text = "探索信息："
 
-[node name="探索" type="GridContainer" parent="HBoxContainer/VBoxContainer/VBoxContainer2"]
+[node name="探索" type="GridContainer" parent="VBoxContainer/HBoxContainer/VBoxContainer/VBoxContainer2"]
 layout_mode = 2
 columns = 10
 
-[node name="空白" type="VBoxContainer" parent="HBoxContainer/VBoxContainer"]
+[node name="空白" type="VBoxContainer" parent="VBoxContainer/HBoxContainer/VBoxContainer"]
 layout_mode = 2
 size_flags_vertical = 3
 
-[node name="操作" type="GridContainer" parent="HBoxContainer/VBoxContainer"]
+[node name="操作" type="GridContainer" parent="VBoxContainer/HBoxContainer/VBoxContainer"]
 layout_mode = 2
 theme_override_constants/h_separation = 20
 theme_override_constants/v_separation = 20
+columns = 10
 
-[node name="Button" type="Button" parent="HBoxContainer/VBoxContainer/操作"]
+[node name="修炼" parent="VBoxContainer/HBoxContainer/VBoxContainer/操作" instance=ExtResource("2_wxjyr")]
+layout_mode = 2
+text = "修炼"
+
+[node name="升级" parent="VBoxContainer/HBoxContainer/VBoxContainer/操作" instance=ExtResource("2_wxjyr")]
+visible = false
 layout_mode = 2
-text = "操作"
+text = "升级"
 
-[node name="空白" type="HBoxContainer" parent="HBoxContainer"]
+[node name="查看大地图" type="Button" parent="VBoxContainer/HBoxContainer/VBoxContainer/操作"]
+layout_mode = 2
+text = "查看大地图"
+
+[node name="空白" type="HBoxContainer" parent="VBoxContainer/HBoxContainer"]
 layout_mode = 2
 size_flags_horizontal = 3
 
-[node name="地图详情" parent="HBoxContainer" instance=ExtResource("1_21xrs")]
+[node name="地图详情" parent="VBoxContainer/HBoxContainer" instance=ExtResource("1_21xrs")]
 custom_minimum_size = Vector2(160, 0)
 layout_mode = 2
 size_flags_horizontal = 1
+
+[connection signal="pressed" from="VBoxContainer/HBoxContainer/VBoxContainer/操作/修炼" to="." method="_on_修炼_pressed"]
+[connection signal="pressed" from="VBoxContainer/HBoxContainer/VBoxContainer/操作/升级" to="." method="_on_升级_pressed"]
Index: ui/others/动作冷却按钮/动作冷却按钮.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/others/动作冷却按钮/动作冷却按钮.gd b/ui/others/动作冷却按钮/动作冷却按钮.gd
new file mode 100644
--- /dev/null	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
+++ b/ui/others/动作冷却按钮/动作冷却按钮.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -0,0 +1,26 @@
+extends Button
+@export var action_cool_times_callable:Callable
+# 字符串备份
+var text_bak:String=""
+
+func init(action_cool_times_callable:Callable):
+	self.action_cool_times_callable=action_cool_times_callable
+	self.text_bak=self.text
+	pass
+
+func _ready() -> void:
+	self.text_bak=self.text
+
+func _process(delta: float) -> void:
+	if GlobalInfo.is_pause:
+		return
+	if !action_cool_times_callable:
+		return
+	if action_cool_times_callable.call()>0:
+		self.disabled=true
+		self.text=self.text_bak+"（剩余%.0f秒）"%action_cool_times_callable.call()
+	else:
+		if self.disabled:
+			self.disabled=false
+			self.text=self.text_bak
+	pass
Index: ui/others/动作冷却按钮/动作冷却按钮.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/others/动作冷却按钮/动作冷却按钮.tscn b/ui/others/动作冷却按钮/动作冷却按钮.tscn
new file mode 100644
--- /dev/null	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
+++ b/ui/others/动作冷却按钮/动作冷却按钮.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -0,0 +1,6 @@
+[gd_scene load_steps=2 format=3 uid="uid://cwxnvif5krapq"]
+
+[ext_resource type="Script" path="res://ui/others/动作冷却按钮/动作冷却按钮.gd" id="1_rg171"]
+
+[node name="动作冷却按钮" type="Button"]
+script = ExtResource("1_rg171")
Index: ui/tips/人员点击tips/人员点击tips.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/tips/人员点击tips/人员点击tips.gd b/ui/tips/人员点击tips/人员点击tips.gd
new file mode 100644
--- /dev/null	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
+++ b/ui/tips/人员点击tips/人员点击tips.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -0,0 +1,7 @@
+extends VBoxContainer
+
+func init(people:People):
+	# 点击人员就得暂停，防止人立刻了还能继续操作
+	GlobalInfo.is_pause=true
+	$"人物详情".init(people)
+	pass
Index: ui/tips/人员点击tips/人员点击tips.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/tips/人员点击tips/人员点击tips.tscn b/ui/tips/人员点击tips/人员点击tips.tscn
new file mode 100644
--- /dev/null	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
+++ b/ui/tips/人员点击tips/人员点击tips.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -0,0 +1,21 @@
+[gd_scene load_steps=3 format=3 uid="uid://032gjitbhijh"]
+
+[ext_resource type="PackedScene" uid="uid://dekyku5jukbs2" path="res://ui/人物详情/人物详情.tscn" id="1_2mcjh"]
+[ext_resource type="Script" path="res://ui/tips/人员点击tips/人员点击tips.gd" id="1_qya16"]
+
+[node name="人员点击tips" type="VBoxContainer"]
+script = ExtResource("1_qya16")
+
+[node name="人物详情" parent="." instance=ExtResource("1_2mcjh")]
+layout_mode = 2
+
+[node name="空" type="VBoxContainer" parent="."]
+layout_mode = 2
+size_flags_vertical = 3
+
+[node name="操作" type="VBoxContainer" parent="."]
+layout_mode = 2
+
+[node name="Button" type="Button" parent="操作"]
+layout_mode = 2
+text = "操作"
Index: ui/tips/地图点击tips/地图详情.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/tips/地图点击tips/地图详情.gd b/ui/tips/地图点击tips/地图详情.gd
--- a/ui/tips/地图点击tips/地图详情.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/ui/tips/地图点击tips/地图详情.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -1,6 +1,7 @@
 extends VBoxContainer
 
 func init(place:Place):
+	$"名称".text=place.name_str
 	$"灵气值".propertie=place.current_lin_qi
 	$"生产速度".propertie=place.product_speeding
 	$"生产量".propertie=place.product_value
Index: ui/tips/地图点击tips/地图详情.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/tips/地图点击tips/地图详情.tscn b/ui/tips/地图点击tips/地图详情.tscn
--- a/ui/tips/地图点击tips/地图详情.tscn	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/ui/tips/地图点击tips/地图详情.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -14,6 +14,9 @@
 size_flags_vertical = 3
 script = ExtResource("1_mf0y2")
 
+[node name="名称" type="Label" parent="."]
+layout_mode = 2
+
 [node name="灵气值" parent="." instance=ExtResource("1_16ar1")]
 layout_mode = 2
 "名称" = "灵气值"
Index: ui/人物详情/人物详情.gd
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/人物详情/人物详情.gd b/ui/人物详情/人物详情.gd
--- a/ui/人物详情/人物详情.gd	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/ui/人物详情/人物详情.gd	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -14,7 +14,7 @@
 	$寿命.propertie=people.max_life
 	$灵气值.propertie=people.lingqi
 	$吸收灵气量.propertie=people.lingqi_absorb
-	$吸收灵气冷却时间.propertie=people.lingqi_absorb_cool_time
+	$吸收灵气冷却.propertie=people.lingqi_absorb_cool_time
 	$生命值.propertie=people.hp
 	$攻击力.propertie=people.atk
 	$防御力.propertie=people.def
Index: ui/人物详情/人物详情.tscn
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/ui/人物详情/人物详情.tscn b/ui/人物详情/人物详情.tscn
--- a/ui/人物详情/人物详情.tscn	(revision 4cd22971386fd88f7453c2539b6c959accc79885)
+++ b/ui/人物详情/人物详情.tscn	(revision f2f394dc84fa62f2858de78a266c5071612ee765)
@@ -33,9 +33,9 @@
 layout_mode = 2
 "名称" = "吸收灵气量"
 
-[node name="吸收灵气冷却时间" parent="." instance=ExtResource("2_egbrg")]
+[node name="吸收灵气冷却" parent="." instance=ExtResource("2_egbrg")]
 layout_mode = 2
-"名称" = "吸收灵气冷却时间"
+"名称" = "吸收灵气冷却"
 
 [node name="生命值" parent="." instance=ExtResource("1_1i8yk")]
 layout_mode = 2
